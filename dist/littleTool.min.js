(function(b){var c={currentLi:-1,onSubmit:function(d){},returnFn:function(e,d){b.each(e.result,function(f,g){d.append('<li class="proposal" data-idx="'+g.id+'" data-namex="'+g.name+'">'+g.name+"</li>")})}};b.fn.autoComplete=function(d){return this.each(function(){var e=this;e.param=b.extend({},c,d);var f=new a(this.param);f.init(b(this));f.hiddenDom(b(this));f.keyPress(b(this),e.param);f.changeEvent(b(this),e.param);f.hiddenList(b(this))})};function a(d){return this.options=d,this}a.prototype.init=function(f){var d=b("<div></div>").addClass("autocomplete-container");var e=b('<div class="proposal-box"></div>').css("width",f.outerWidth()).css("top",f.outerHeight());this.proposalList=b('<ul class="proposal-ul"></ul>');e.append(this.proposalList);f.wrap(d).after(e);this.newDom()};a.prototype.hiddenDom=function(d){this.inputHidden=b('<input type="hidden" class="proposal-id" />');d.before(this.inputHidden)};a.prototype.newDom=function(){this.proposalList.empty()};a.prototype.keyPress=function(e,d){var f=this;e.keydown(function(g){switch(g.which){case 38:g.preventDefault();f.proposalList.find("li").removeClass("selected");if((currentLi-1)>=0){currentLi--;f.proposalList.find("li:eq("+currentLi+")").addClass("selected")}else{currentLi=-1}break;case 40:console.log("down_currentLi="+currentLi);console.log("length="+f.proposalList.find("li").length);g.preventDefault();if((currentLi+1)<f.proposalList.find("li").length){f.proposalList.find("li").removeClass("selected");currentLi++;f.proposalList.find("li:eq("+currentLi+")").addClass("selected")}break;case 13:if(currentLi>-1){var h=f.proposalList.find("li:eq("+currentLi+")").html();e.val(h)}currentLi=-1;f.proposalList.empty();d.onSubmit(e.val());break;case 27:currentLi=-1;f.proposalList.empty();e.val("");break}})};a.prototype.changeEvent=function(e,d){var f=this;e.bind("input propertychange",function(i){var h=b(this);if(i.which!=40&&i.which!=38&&i.which!=13&&i.which!=27){currentLi=-1;f.proposalList.empty();e.prop("autocomplete","off");if(e.val().length<1){f.proposalList.empty()}else{f.proposalList.empty();var g={};g.datatime=+new Date;g[d.dataName]=e.val();console.log("dataobj",g);b.ajax({type:"POST",url:d.url,data:g}).done(function(j){f.proposalList.empty();d.returnFn.call(h,j,f.proposalList);f.proposalList.find(".proposal").click(function(m){var n=b(m.target);var k=n.data("idx");var l=n.data("namex");e.val(l).data("idx",k);b(f.inputHidden).val(k);if(d.callback){d.callback()}f.proposalList.empty();d.onSubmit(e.val())}).mouseenter(function(){b(this).addClass("selected")}).mouseleave(function(){b(this).removeClass("selected")})})}}return d})};a.prototype.hiddenList=function(){var d=this;b(document).on("click",function(e){currentLi=-1;var f=b(e.target);if(f.closest(".preview").length==0){d.proposalList.empty()}})}})(jQuery);(function(b){var c={countNum:20};b.fn.limitNum=function(d){return this.each(function(){var g=this;g.opts=b.extend({},c,d);var f=b("<div></div>").addClass("wordCount");var e=b('<span class="wordWrap"><span class="wordNum">'+g.opts.countNum+"</span>/"+g.opts.countNum+"</span>");b(this).wrap(f).after(e);a(this,g.opts)})};function a(e,f){var d=f.countNum;b(e).bind("input propertychange",function(){var h=b(this).val().length,g=b(this).closest(".wordCount").find(".wordNum");g.text(d-h);if(h>d){b(this).val(b(this).val().substring(0,d));g.text(0)}})}})(jQuery);